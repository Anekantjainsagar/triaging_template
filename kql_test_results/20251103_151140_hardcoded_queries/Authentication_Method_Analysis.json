{
  "query_name": "Authentication Method Analysis",
  "query_type": "hardcoded",
  "timestamp": "2025-11-03T15:11:48.298226",
  "stages": {
    "template_validation": {
      "passed": true,
      "query_length": 1455
    },
    "data_injection": {
      "passed": true,
      "injected_query_length": 1541,
      "users_injected": 1,
      "ips_injected": 1,
      "reference_datetime": "2025-11-03 10:30:00"
    },
    "execution": {
      "success": true,
      "execution_time": 2.76,
      "formatted_output": "Results: 1 row(s) returned\n\n================================================================================\nUserPrincipalName     | MFAStatus          | MFAAdoptionRate | TotalSignIns    | AuthSuccessRate | UniqueAuthMethods | UniqueClientApps | MFARequired     | SingleFactorAuth | SuccessfulAuths | FailedAuths     | BrowserSignIns  | MobileAppSignIns | AuthMethodsList             | ClientAppsList                               \n-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\nanekant.jain@yash.com | Fair - Partial MFA | 62.5            | 8               | 75              | 2                 | 2                | 5               | 3                | 6               | 2               | 3               | 5                | [\"\",\"Previously satisfied\"] | [\"Mobile Apps and Desktop clients\",\"Browser\"]\n================================================================================\n\nTotal Records: 1",
      "raw_results": {
        "tables": [
          {
            "name": "PrimaryResult",
            "columns": [
              {
                "name": "UserPrincipalName",
                "type": "string"
              },
              {
                "name": "MFAStatus",
                "type": "string"
              },
              {
                "name": "MFAAdoptionRate",
                "type": "real"
              },
              {
                "name": "TotalSignIns",
                "type": "long"
              },
              {
                "name": "AuthSuccessRate",
                "type": "real"
              },
              {
                "name": "UniqueAuthMethods",
                "type": "long"
              },
              {
                "name": "UniqueClientApps",
                "type": "long"
              },
              {
                "name": "MFARequired",
                "type": "long"
              },
              {
                "name": "SingleFactorAuth",
                "type": "long"
              },
              {
                "name": "SuccessfulAuths",
                "type": "long"
              },
              {
                "name": "FailedAuths",
                "type": "long"
              },
              {
                "name": "BrowserSignIns",
                "type": "long"
              },
              {
                "name": "MobileAppSignIns",
                "type": "long"
              },
              {
                "name": "AuthMethodsList",
                "type": "dynamic"
              },
              {
                "name": "ClientAppsList",
                "type": "dynamic"
              }
            ],
            "rows": [
              [
                "anekant.jain@yash.com",
                "Fair - Partial MFA",
                62.5,
                8,
                75,
                2,
                2,
                5,
                3,
                6,
                2,
                3,
                5,
                "[\"\",\"Previously satisfied\"]",
                "[\"Mobile Apps and Desktop clients\",\"Browser\"]"
              ]
            ]
          }
        ]
      },
      "result_rows": 1
    }
  },
  "injected_query": "SigninLogs\n| where TimeGenerated > datetime(2025-10-27 10:30:00Z) and TimeGenerated <= datetime(2025-11-03 10:30:00Z)\n| where UserPrincipalName in (\"anekant.jain@yash.com\")\n| extend AuthenticationDetails = todynamic(AuthenticationDetails)\n| mv-expand AuthDetail = AuthenticationDetails\n| extend \n    AuthMethod = tostring(AuthDetail.authenticationMethod),\n    AuthSuccess = tostring(AuthDetail.succeeded)\n| summarize\n    TotalSignIns = count(),\n    UniqueAuthMethods = dcount(AuthMethod),\n    UniqueClientApps = dcount(ClientAppUsed),\n    MFARequired = countif(AuthenticationRequirement == \"multiFactorAuthentication\"),\n    SingleFactorAuth = countif(AuthenticationRequirement == \"singleFactorAuthentication\"),\n    SuccessfulAuths = countif(ResultType == \"0\"),\n    FailedAuths = countif(ResultType != \"0\"),\n    BrowserSignIns = countif(ClientAppUsed == \"Browser\"),\n    MobileAppSignIns = countif(ClientAppUsed == \"Mobile Apps and Desktop clients\"),\n    AuthMethodsList = make_set(AuthMethod, 10),\n    ClientAppsList = make_set(ClientAppUsed, 10)\n    by UserPrincipalName\n| extend\n    MFAAdoptionRate = round(100.0 * MFARequired / TotalSignIns, 2),\n    AuthSuccessRate = round(100.0 * SuccessfulAuths / TotalSignIns, 2)\n| extend\n    MFAStatus = case(\n        MFAAdoptionRate >= 90, \"Excellent - Strong MFA\",\n        MFAAdoptionRate >= 70, \"Good - Moderate MFA\", \n        MFAAdoptionRate >= 50, \"Fair - Partial MFA\",\n        \"Poor - Weak MFA\"\n    )\n| project-reorder UserPrincipalName, MFAStatus, MFAAdoptionRate, TotalSignIns, AuthSuccessRate",
  "status": "PASSED"
}