====================================================================================================
Query: Authentication Method Analysis
Type: hardcoded
Status: PASSED
Timestamp: 2025-11-03T15:11:48.298226
====================================================================================================

STAGE RESULTS:
----------------------------------------------------------------------------------------------------

TEMPLATE_VALIDATION:
  passed: True
  query_length: 1455

DATA_INJECTION:
  passed: True
  injected_query_length: 1541
  users_injected: 1
  ips_injected: 1
  reference_datetime: 2025-11-03 10:30:00

EXECUTION:
  success: True
  execution_time: 2.76
  formatted_output:
    Results: 1 row(s) returned

================================================================================
UserPrincipalName     | MFAStatus          | MFAAdoptionRate | TotalSignIns    | AuthSuccessRate | UniqueAuthMethods | UniqueClientApps | MFARequired     | SingleFactorAuth | SuccessfulAuths | FailedAuths     | BrowserSignIns  | MobileAppSignIns | AuthMethodsList             | ClientAppsList                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
anekant.jain@yash.com | Fair - Partial MFA | 62.5            | 8               | 75              | 2                 | 2                | 5               | 3                | 6               | 2               | 3               | 5                | ["","Previously satisfied"] | ["Mobile Apps and Desktop clients","Browser"]
================================================================================

Total Records: 1
  raw_results: {'tables': [{'name': 'PrimaryResult', 'columns': [{'name': 'UserPrincipalName', 'type': 'string'}, {'name': 'MFAStatus', 'type': 'string'}, {'name': 'MFAAdoptionRate', 'type': 'real'}, {'name': 'TotalSignIns', 'type': 'long'}, {'name': 'AuthSuccessRate', 'type': 'real'}, {'name': 'UniqueAuthMethods', 'type': 'long'}, {'name': 'UniqueClientApps', 'type': 'long'}, {'name': 'MFARequired', 'type': 'long'}, {'name': 'SingleFactorAuth', 'type': 'long'}, {'name': 'SuccessfulAuths', 'type': 'long'}, {'name': 'FailedAuths', 'type': 'long'}, {'name': 'BrowserSignIns', 'type': 'long'}, {'name': 'MobileAppSignIns', 'type': 'long'}, {'name': 'AuthMethodsList', 'type': 'dynamic'}, {'name': 'ClientAppsList', 'type': 'dynamic'}], 'rows': [['anekant.jain@yash.com', 'Fair - Partial MFA', 62.5, 8, 75, 2, 2, 5, 3, 6, 2, 3, 5, '["","Previously satisfied"]', '["Mobile Apps and Desktop clients","Browser"]']]}]}
  result_rows: 1

====================================================================================================
INJECTED QUERY (READY TO EXECUTE):
====================================================================================================
SigninLogs
| where TimeGenerated > datetime(2025-10-27 10:30:00Z) and TimeGenerated <= datetime(2025-11-03 10:30:00Z)
| where UserPrincipalName in ("anekant.jain@yash.com")
| extend AuthenticationDetails = todynamic(AuthenticationDetails)
| mv-expand AuthDetail = AuthenticationDetails
| extend 
    AuthMethod = tostring(AuthDetail.authenticationMethod),
    AuthSuccess = tostring(AuthDetail.succeeded)
| summarize
    TotalSignIns = count(),
    UniqueAuthMethods = dcount(AuthMethod),
    UniqueClientApps = dcount(ClientAppUsed),
    MFARequired = countif(AuthenticationRequirement == "multiFactorAuthentication"),
    SingleFactorAuth = countif(AuthenticationRequirement == "singleFactorAuthentication"),
    SuccessfulAuths = countif(ResultType == "0"),
    FailedAuths = countif(ResultType != "0"),
    BrowserSignIns = countif(ClientAppUsed == "Browser"),
    MobileAppSignIns = countif(ClientAppUsed == "Mobile Apps and Desktop clients"),
    AuthMethodsList = make_set(AuthMethod, 10),
    ClientAppsList = make_set(ClientAppUsed, 10)
    by UserPrincipalName
| extend
    MFAAdoptionRate = round(100.0 * MFARequired / TotalSignIns, 2),
    AuthSuccessRate = round(100.0 * SuccessfulAuths / TotalSignIns, 2)
| extend
    MFAStatus = case(
        MFAAdoptionRate >= 90, "Excellent - Strong MFA",
        MFAAdoptionRate >= 70, "Good - Moderate MFA", 
        MFAAdoptionRate >= 50, "Fair - Partial MFA",
        "Poor - Weak MFA"
    )
| project-reorder UserPrincipalName, MFAStatus, MFAAdoptionRate, TotalSignIns, AuthSuccessRate

====================================================================================================
QUERY EXECUTION RESULTS:
====================================================================================================
Execution Time: 2.76 seconds
Result Rows: 1
Success: True

FORMATTED OUTPUT:
----------------------------------------------------------------------------------------------------
Results: 1 row(s) returned

================================================================================
UserPrincipalName     | MFAStatus          | MFAAdoptionRate | TotalSignIns    | AuthSuccessRate | UniqueAuthMethods | UniqueClientApps | MFARequired     | SingleFactorAuth | SuccessfulAuths | FailedAuths     | BrowserSignIns  | MobileAppSignIns | AuthMethodsList             | ClientAppsList                               
-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
anekant.jain@yash.com | Fair - Partial MFA | 62.5            | 8               | 75              | 2                 | 2                | 5               | 3                | 6               | 2               | 3               | 5                | ["","Previously satisfied"] | ["Mobile Apps and Desktop clients","Browser"]
================================================================================

Total Records: 1

====================================================================================================
RAW RESULTS (JSON):
====================================================================================================
{
  "tables": [
    {
      "name": "PrimaryResult",
      "columns": [
        {
          "name": "UserPrincipalName",
          "type": "string"
        },
        {
          "name": "MFAStatus",
          "type": "string"
        },
        {
          "name": "MFAAdoptionRate",
          "type": "real"
        },
        {
          "name": "TotalSignIns",
          "type": "long"
        },
        {
          "name": "AuthSuccessRate",
          "type": "real"
        },
        {
          "name": "UniqueAuthMethods",
          "type": "long"
        },
        {
          "name": "UniqueClientApps",
          "type": "long"
        },
        {
          "name": "MFARequired",
          "type": "long"
        },
        {
          "name": "SingleFactorAuth",
          "type": "long"
        },
        {
          "name": "SuccessfulAuths",
          "type": "long"
        },
        {
          "name": "FailedAuths",
          "type": "long"
        },
        {
          "name": "BrowserSignIns",
          "type": "long"
        },
        {
          "name": "MobileAppSignIns",
          "type": "long"
        },
        {
          "name": "AuthMethodsList",
          "type": "dynamic"
        },
        {
          "name": "ClientAppsList",
          "type": "dynamic"
        }
      ],
      "rows": [
        [
          "anekant.jain@yash.com",
          "Fair - Partial MFA",
          62.5,
          8,
          75,
          2,
          2,
          5,
          3,
          6,
          2,
          3,
          5,
          "[\"\",\"Previously satisfied\"]",
          "[\"Mobile Apps and Desktop clients\",\"Browser\"]"
        ]
      ]
    }
  ]
}
