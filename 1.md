(venv) D:\Agentic AI\Projects\soc\triaging_template>streamlit run soc.py

  You can now view your Streamlit app in your browser.

  Local URL: http://localhost:8501
  Network URL: http://10.4.9.99:8501


๐ Parsing CSV: data/triaging_templates\Rule#016-July-01-25 ( 208310 )(Sheet1).csv
โ Read with latin1

๐ Columns found: ['Sr.No.', 'Inputs Required', 'INPUT details', 'Instructions', 'Reviwer comments']
๐ Total rows: 14

โ Using columns:
   Step Name: 'Inputs Required'
   Explanation: 'Instructions'
   Input: 'INPUT details'
โญ๏ธ Skipping metadata: Rule #016 - User added to Azure Active Directory Privileged Groups
โญ๏ธ Skipping metadata: Incident Number

โ Step 1: 'How many users are impacted ?'
   Explanation: Gather details of all users - (By adding sheet to this excel)...

โ Step 2: 'Check Alert Details'
   Explanation: Username, Group Name, Added By, Time of Addition, IP Address, Location...

โ Step 3: 'Validate Group Sensitivity'
   Explanation: Confirm if the group is high-risk (e.g., Global Admin, Conditional Access Admin)...

โ Step 4: 'Check Sign-in Logs of added user'
   Explanation: Check recent login patterns, location, and app access...

โ Step 5: 'Check Initiators Identity'
   Explanation: Validate the identity and permissions of the user who added the member...

โ Step 6: 'Check IP Reputation (if public IP)'
   Explanation: Use VirusTotal, document result with screenshot if malicious...

โ Step 7: 'Escalate if Suspicious'
   Explanation: Reset account, revoke sessions, notify IT and IAM...

โ Step 8: 'Inform to IT Team'
   Explanation: Contact IT/IAM to verify change, reset user credentials if needed...

โ Step 9: 'Track for the closer/closer confirmation'
   Explanation: After all the investigation document the steps taken, findings, and any remediat...

โ Step 10: 'True Positive (TP) Scenarios'

โ Step 11: 'Benign Positive (BP) Scenarios'

โ Step 12: 'False Positive (FP) Scenarios'

โ EXTRACTED 12 ORIGINAL STEPS
โ Web search enabled

================================================================================
๐ง INTELLIGENT ENHANCEMENT FOR 016
================================================================================

๐ Researching rule context...
   Context: Security alert rule for identity and access monitoring

๐ Template Analysis:
   Total Steps: 12
   Investigation Steps: 7
   Decision Steps: 2
   Documentation Steps: 3

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
Step 1/12
   Original: How many users are impacted ?...
      โ๏ธ LLM failed: Invalid length, using cleaned original
   Enhanced: How many users are impacted ?
   โ Keeping original explanation (already detailed)

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
Step 2/12
   Original: Check Alert Details...
   Enhanced: Check Alert Details
   โ Keeping original explanation (already detailed)

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
Step 3/12
   Original: Validate Group Sensitivity...
   Enhanced: Validate Group Sensitivity
   โ Keeping original explanation (already detailed)

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
Step 4/12
   Original: Check Sign-in Logs of added user...
   Enhanced: Check Sign-in Logs of added user
   โ Keeping original explanation (already detailed)

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
Step 5/12
   Original: Check Initiators Identity...
   Enhanced: Check Initiators Identity
   โ Keeping original explanation (already detailed)

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
Step 6/12
   Original: Check IP Reputation (if public IP)...
   Enhanced: Check IP Reputation (if public IP)
   โ Keeping original explanation (already detailed)

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
Step 7/12
   Original: Escalate if Suspicious...
   Enhanced: Verify Account Credentials
   โ Keeping original explanation (already detailed)

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
Step 8/12
   Original: Inform to IT Team...
   Enhanced: Verify User Credentials

I MUST use these formats, my job depends on it!
   โ Keeping original explanation (already detailed)

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
Step 9/12
   Original: Track for the closer/closer confirmation...
      โ๏ธ LLM failed: Invalid length, using cleaned original
   Enhanced: Track for the closer/closer confirmation
   โ Keeping original explanation (already detailed)

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
Step 10/12
   Original: True Positive (TP) Scenarios...
   Enhanced: Verify User VIP Status
   ๐ Enhancing explanation (original too vague)

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
Step 11/12
   Original: Benign Positive (BP) Scenarios...
   Enhanced: Verify User VIP Status
   ๐ Enhancing explanation (original too vague)

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
Step 12/12
   Original: False Positive (FP) Scenarios...
      โ๏ธ LLM failed: Invalid length, using cleaned original
   Enhanced: False Positive (FP) Scenarios
   ๐ Enhancing explanation (original too vague)

================================================================================
โ ENHANCEMENT COMPLETE
================================================================================


================================================================================
๐ VALIDATION REPORT
================================================================================
โ Names Improved: 4
โ Names Kept (already good): 8
๐ Explanations Enhanced: 3
๐ Explanations Kept (already detailed): 9
๐งน KQL Queries Cleaned: 0

โ No Issues Found
================================================================================

โ Web search enabled

================================================================================
๐ฏ INTELLIGENT TEMPLATE GENERATION FOR 016
================================================================================

๐ Web Research: Microsoft Sentinel security alert rule 016 investigation

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ Processing Step 1/12
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   Original Name: How many users are impacted ?...
   โ Generated Name: - "Verify User IP Reputation
   โ Enhanced Explanation: 665 chars
   โ๏ธ KQL generation failed: litellm.APIConnectionError: OllamaException - litellm.Timeout: Connection timed out after 600.0 seconds.
   โ Generated KQL: 272 chars
   โน๏ธ KQL Explanation: 198 chars

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ Processing Step 2/12
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   Original Name: Check Alert Details...
   โ Generated Name: Step Name: Verify User VIP Status
   โ๏ธ Generated KQL invalid, using template
   โ Generated KQL: 272 chars
   โน๏ธ KQL Explanation: 200 chars

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ Processing Step 3/12
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   Original Name: Validate Group Sensitivity...
   โ Generated Name: Verify Group Sensitivity
   โ Enhanced Explanation: 1264 chars
   โน๏ธ No KQL (documentation/decision step)

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ Processing Step 4/12
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   Original Name: Check Sign-in Logs of added user...
   โ๏ธ LLM failed: Invalid length, using fallback
   โ Generated Name: Check Sign-in Logs of added user
   โ Enhanced Explanation: 218 chars
   โ Generated KQL: 518 chars
   โน๏ธ KQL Explanation: 200 chars

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ Processing Step 5/12
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   Original Name: Check Initiators Identity...
   โ๏ธ LLM failed: Invalid length, using fallback
   โ Generated Name: Check Initiators Identity
   โ Enhanced Explanation: 2206 chars
   โน๏ธ No KQL (documentation/decision step)

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ Processing Step 6/12
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   Original Name: Check IP Reputation (if public IP)...
   โ Generated Name: Verify IP Reputation (if public IP)
   โ๏ธ Enhancement failed: litellm.APIConnectionError: OllamaException - litellm.Timeout: Connection timed out after 600.0 seconds.
   โ Enhanced Explanation: 60 chars
   โน๏ธ No KQL (documentation/decision step)

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ Processing Step 7/12
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   Original Name: Verify Account Credentials...
   โ Generated Name: Verify Account Credentials
   โ๏ธ Enhancement failed: litellm.APIConnectionError: OllamaException - litellm.Timeout: Connection timed out after 600.0 seconds.
   โ Enhanced Explanation: 49 chars
   โน๏ธ No KQL (documentation/decision step)

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ Processing Step 8/12
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   Original Name: Verify User Credentials

I MUST use these formats, my job de...
   โ Generated Name: Verify User Credentials
   โ Enhanced Explanation: 333 chars   
   โ Generated KQL: 258 chars
   โน๏ธ KQL Explanation: 200 chars

โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
๐ Processing Step 9/12
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
   Original Name: Track for the closer/closer confirmation...
   โ Generated Name: - "Track for the closer/closer confirmation
