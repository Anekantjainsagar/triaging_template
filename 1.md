Step Name Explanation KQL Query KQL Explanation Execute Output Remarks/Comments
Manual Analysis: Test-Suspicious signins
1 1. Initial Alert Scope & Affected Users "Identify all unique users and the total count of sign-in events flagged as suspicious by the alert. This helps to quickly understand the breadth of the incident and if it's an isolated event or a widespread attack.

ğŸ’¡ WHY THIS MATTERS: Directly quantifies the immediate impact of the ""Test-Suspicious signins"" alert by identifying all potentially compromised accounts." "SigninLogs
| where TimeGenerated > datetime(2025-09-26 12:45:20Z) and TimeGenerated <= datetime(2025-10-03 12:45:20Z)
| summarize UserCount = dcount(UserPrincipalName), TotalSignIns = count()" Queries SigninLogs table to analyze 1. initial alert scope & affected users activity. Query executed successfully but returned no data.
2 2. Authentication Details & Success/Failure Analysis "For each identified suspicious sign-in, examine the `ResultType` and `ResultDescription` to determine if the sign-in was successful or failed. Investigate the `AuthenticationRequirement` (e.g., MFA), `AuthenticationMethod` used, and the `AppDisplayName` or `ResourceDisplayName` that was accessed. This determines if unauthorized access occurred and what resources might have been compromised.

ğŸ’¡ WHY THIS MATTERS: Provides crucial details on the outcome of the suspicious sign-in, indicating if a breach occurred and what applications were targeted." "SigninLogs
| where TimeGenerated > datetime(2025-09-26 12:45:20Z) and TimeGenerated <= datetime(2025-10-03 12:45:20Z)
| where UserPrincipalName in (""aarushi.trivedi@yashtechnologies841.onmicrosoft.com"", ""saratkumar.indukuri@yashtechnologies841.onmicrosoft.com"", ""shrish.s@yashtechnologies841.onmicrosoft.com"", ""ketan.patel@yashtechnologies841.onmicrosoft.com"")
| summarize SignInCount = count(), UniqueIPs = dcount(IPAddress), FailedAttempts = countif(ResultType != ""0""), UniqueLocations = dcount(tostring(LocationDetails.countryOrRegion)) by UserPrincipalName" Queries SigninLogs table to analyze 2. authentication details & success/failure analysis activity. "Results: 1 row(s) returned

================================================================================
UserCount | TotalSignIns

---

# 0 | 0

Total Records: 1"
3 Verify User Account Status and Check if Account is VIP or High-Priority "This step analyzes the affected user account to determine their role, privileges, and organizational importance. It checks IdentityInfo and AuditLogs to identify if this is a VIP user, admin account, or executive with elevated privileges. This is important because compromising a high-value account poses a significantly greater risk, including potential lateral movement, data exfiltration, and privilege escalation opportunities.

ğŸ’¡ WHY THIS MATTERS: VIP/privileged accounts have access to sensitive data and systems. Compromise of such accounts represents a critical security incident requiring immediate escalation and response." "SigninLogs
| where TimeGenerated > datetime(2025-09-26 12:45:20Z) and TimeGenerated <= datetime(2025-10-03 12:45:20Z)
| summarize UserCount = dcount(UserPrincipalName), TotalSignIns = count()" Queries SigninLogs table to analyze verify user account status and check if account is vip or high-priority activity. "IP Reputation Analysis Report
============================================================

IP Address: 14.143.131.254
Overall Risk: CLEAN (Score: 0/100)
Timestamp: 2025-10-31 17:47:10

============================================================
VIRUSTOTAL RESULTS
============================================================

Malicious Detections: 0/95
Suspicious Detections: 0/95
Clean Detections: 59/95
Country: IN
ASN: 4755
Owner: TATA Communications formerly VSNL is Leading ISP

============================================================
ABUSEIPDB RESULTS
============================================================

Abuse Confidence Score: 0%
Total Reports: 0
Distinct Reporters: 0
Last Reported: None
Country Code: IN
ISP: Internet Service Provider
Usage Type: Fixed Line ISP
Whitelisted: No
Public IP: Yes

============================================================
RECOMMENDATION
============================================================

[NO ACTION] IP appears clean. Continue standard investigation procedures.

VERIFICATION LINKS:
â€¢ VirusTotal: https://www.virustotal.com/gui/ip-address/14.143.131.254
â€¢ AbuseIPDB: https://www.abuseipdb.com/check/14.143.131.254

============================================================

# IP Reputation Analysis Report

IP Address: 49.249.104.218
Overall Risk: CLEAN (Score: 0/100)
Timestamp: 2025-10-31 17:47:12

============================================================
VIRUSTOTAL RESULTS
============================================================

Malicious Detections: 0/95
Suspicious Detections: 0/95
Clean Detections: 61/95
Country: IN
ASN: 45820
Owner: Tata Teleservices ISP AS

============================================================
ABUSEIPDB RESULTS
============================================================

Abuse Confidence Score: 0%
Total Reports: 0
Distinct Reporters: 0
Last Reported: None
Country Code: IN
ISP: Tata Teleservices Limited -GSM Division
Usage Type: Fixed Line ISP
Whitelisted: No
Public IP: Yes

============================================================
RECOMMENDATION
============================================================

[NO ACTION] IP appears clean. Continue standard investigation procedures.

VERIFICATION LINKS:
â€¢ VirusTotal: https://www.virustotal.com/gui/ip-address/49.249.104.218
â€¢ AbuseIPDB: https://www.abuseipdb.com/check/49.249.104.218

============================================================

# IP Reputation Analysis Report

IP Address: 27.6.153.93
Overall Risk: CLEAN (Score: 0/100)
Timestamp: 2025-10-31 17:47:14

============================================================
VIRUSTOTAL RESULTS
============================================================

Malicious Detections: 0/95
Suspicious Detections: 0/95
Clean Detections: 0/95
Country: IN
ASN: 17488
Owner: Hathway IP Over Cable Internet

============================================================
ABUSEIPDB RESULTS
============================================================

Abuse Confidence Score: 0%
Total Reports: 0
Distinct Reporters: 0
Last Reported: None
Country Code: IN
ISP: HATHWAY CABLE AND DATACOM LIMITED
Usage Type: Fixed Line ISP
Whitelisted: No
Public IP: Yes

============================================================
RECOMMENDATION
============================================================

[NO ACTION] IP appears clean. Continue standard investigation procedures.

VERIFICATION LINKS:
â€¢ VirusTotal: https://www.virustotal.com/gui/ip-address/27.6.153.93
â€¢ AbuseIPDB: https://www.abuseipdb.com/check/27.6.153.93

============================================================

# IP Reputation Analysis Report

IP Address: 111.125.237.218
Overall Risk: CLEAN (Score: 0/100)
Timestamp: 2025-10-31 17:47:16

============================================================
VIRUSTOTAL RESULTS
============================================================

Malicious Detections: 0/95
Suspicious Detections: 0/95
Clean Detections: 0/95
Country: IN
ASN: 45769
Owner: D-Vois Broadband Pvt Ltd

============================================================
ABUSEIPDB RESULTS
============================================================

Abuse Confidence Score: 0%
Total Reports: 0
Distinct Reporters: 0
Last Reported: None
Country Code: IN
ISP: D-VoiS Broadband Private Limited
Usage Type: Fixed Line ISP
Whitelisted: No
Public IP: Yes

============================================================
RECOMMENDATION
============================================================

[NO ACTION] IP appears clean. Continue standard investigation procedures.

VERIFICATION LINKS:
â€¢ VirusTotal: https://www.virustotal.com/gui/ip-address/111.125.237.218
â€¢ AbuseIPDB: https://www.abuseipdb.com/check/111.125.237.218

============================================================"
4 Check Source IP Reputation Using VirusTotal and AbuseIPDB "This step validates the reputation of the source IP address using external threat intelligence platforms (VirusTotal and AbuseIPDB) to identify if the IP is associated with known malicious activity. This is important because a malicious IP address is a strong indicator of compromise or attack. Look for high detection ratios (5+ vendors), recent abuse reports, or associations with known threat actors.

ğŸ’¡ WHY THIS MATTERS: IP reputation provides immediate validation of the threat level. A malicious source IP strongly indicates this is not a legitimate access attempt." Requires manual checking using external tools (VirusTotal, AbuseIPDB) or the integrated IP reputation checker in the triaging app. "Results: 1 row(s) returned

================================================================================
UserCount | TotalSignIns

---

# 0 | 0

Total Records: 1"
5 3. Geographic & Impossible Travel Analysis "Compare the `Location` (City, State, Country) of the suspicious sign-in with the affected user's recent legitimate sign-in locations. Look for sign-ins from unusual countries or impossible travel scenarios (e.g., sign-ins from two geographically distant locations within an implausible time frame).

ğŸ’¡ WHY THIS MATTERS: A primary indicator of compromised credentials is sign-ins from unexpected or geographically impossible locations, directly addressing the ""suspicious"" nature of the alert." "SigninLogs
| where TimeGenerated > datetime(2025-09-26 12:45:20Z) and TimeGenerated <= datetime(2025-10-03 12:45:20Z)
| summarize UserCount = dcount(UserPrincipalName), TotalSignIns = count()" Queries SigninLogs table to analyze 3. geographic & impossible travel analysis activity. Query executed successfully but returned no data.
6 4. Threat Intelligence Lookup of Source IP "Extract the `IPAddress` associated with the suspicious sign-in events. Perform a threat intelligence lookup on these IP addresses to check if they are known for malicious activity, are associated with VPNs, TOR exit nodes, or have a poor reputation.

ğŸ’¡ WHY THIS MATTERS: Provides external context to the suspicious sign-in, indicating if the source IP is a known threat actor or a common evasion technique." "SigninLogs
| where TimeGenerated > datetime(2025-09-26 12:45:20Z) and TimeGenerated <= datetime(2025-10-03 12:45:20Z)
| where IPAddress in (""14.143.131.254"", ""49.249.104.218"", ""27.6.153.93"", ""111.125.237.218"")
| summarize SignInAttempts = count(), UniqueUsers = dcount(UserPrincipalName), FailedLogins = countif(ResultType != ""0"") by IPAddress" Queries SigninLogs table to analyze 4. threat intelligence lookup of source ip activity. Query executed successfully but returned no data.
7 5. Post-Sign-in User Activity & Behavioral Anomalies "If the suspicious sign-in was successful, examine `AuditLogs` for any subsequent actions performed by the affected user _after_ the suspicious sign-in time. Look for unusual resource access, administrative changes, creation of new accounts, changes to mailbox forwarding rules, or data exfiltration attempts that deviate from the user's normal behavior.

ğŸ’¡ WHY THIS MATTERS: Determines if the suspicious sign-in led to further malicious activity or post-compromise actions within the environment." "let suspiciousSignInTime = datetime(2023-10-01T12:00:00Z); // Replace with actual suspicious sign-in time
let userId = ""user@example.com""; // Replace with actual user ID
AuditLogs
| where TimeGenerated > suspiciousSignInTime
| where InitiatedBy == userId
| summarize ActionCount = count() by OperationName, bin(TimeGenerated, 1h)
| order by ActionCount desc" Queries AuditLogs table to analyze 5. post-sign-in user activity & behavioral anomalies activity. Query executed successfully but returned no data.
8 6. Device Health & Compliance Check "If a `DeviceId` or `DeviceName` is associated with the suspicious sign-in (either directly from `SigninLogs` or inferred), query `DeviceInfo` to check its health status, compliance posture, operating system, and any recent security alerts or vulnerabilities. This helps determine if the sign-in originated from a compromised or non-compliant device.

ğŸ’¡ WHY THIS MATTERS: Assesses the security posture of the endpoint involved in the suspicious sign-in, which could indicate a device compromise or an unmanaged device being used." "SigninLogs
| where TimeGenerated > datetime(2025-09-26 12:45:20Z) and TimeGenerated <= datetime(2025-10-03 12:45:20Z)
| where UserPrincipalName in (""aarushi.trivedi@yashtechnologies841.onmicrosoft.com"", ""saratkumar.indukuri@yashtechnologies841.onmicrosoft.com"", ""shrish.s@yashtechnologies841.onmicrosoft.com"", ""ketan.patel@yashtechnologies841.onmicrosoft.com"")
| summarize SignInCount = count(), UniqueIPs = dcount(IPAddress), FailedAttempts = countif(ResultType != ""0""), UniqueLocations = dcount(tostring(LocationDetails.countryOrRegion)) by UserPrincipalName" Queries SigninLogs table to analyze 6. device health & compliance check activity. "Results: 1 row(s) returned

================================================================================
UserCount | TotalSignIns

---

# 0 | 0

Total Records: 1"
9 7. User Account Configuration Changes "Review `AuditLogs` for any changes made to the affected user's account settings around the time of the suspicious sign-in. This includes password resets, MFA enrollment changes, role assignments, or other critical account modifications. Attackers often modify account settings to maintain persistence or elevate privileges.

ğŸ’¡ WHY THIS MATTERS: Identifies potential persistence mechanisms, privilege escalation attempts, or attempts to bypass security controls related to the suspicious sign-in." "SigninLogs
| where TimeGenerated > datetime(2025-09-26 12:45:20Z) and TimeGenerated <= datetime(2025-10-03 12:45:20Z)
| summarize UserCount = dcount(UserPrincipalName), TotalSignIns = count()" Queries SigninLogs table to analyze 7. user account configuration changes activity.





