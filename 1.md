INFO:backend.predictions_backend:Attempting to configure Gemini API...
INFO:backend.predictions_backend:Gemini API configured.
INFO:backend.predictions_backend:Attempting to initialize GenerativeModel...
INFO:backend.predictions_backend:GenerativeModel initialized.
‚úÖ Investigation Analyzer initialized with API key
INFO:backend.backed_fixes:============================================================
INFO:backend.backed_fixes:EXTRACTING STEPS FOR: temp.user@abc.com
INFO:backend.backed_fixes:Total rows in DataFrame: 5
INFO:backend.backed_fixes:Columns: ['Step', 'Name', 'Explanation', 'KQL Query', 'KQL Explanation', 'Execute', 'Output', 'Remarks/Comments']   
INFO:backend.backed_fixes:Row 0: SKIPPED (Header row - Step=None, Name=297)
INFO:backend.backed_fixes:Row 1: ‚úÖ Step 1 - Verify User Count Impacted (Output: 79ch, Remarks: 0ch)
INFO:backend.backed_fixes:Row 2: ‚úÖ Step 2 - Verify VIP User Credentials (Output: 79ch, Remarks: 0ch)
INFO:backend.backed_fixes:Row 3: ‚úÖ Step 3 - Verify User/Device Location Timestamp (Output: 79ch, Remarks: 0ch)
INFO:backend.backed_fixes:Row 4: ‚úÖ Step 4 - Verify IP Reputation Using VirusTotal (Output: 547ch, Remarks: 0ch)
INFO:backend.backed_fixes:============================================================
INFO:backend.backed_fixes:EXTRACTION COMPLETE: 4 steps extracted
temp.user@abc.com [{'step_number': 1, 'step_name': 'Verify User Count Impacted', 'explanation': 'Gather details of all users - (By adding sheet to this excel)', 'kql_query': 'SigninLogs\n| where UserPrincipalName == "<USER_EMAIL>"\n| where TimeGenerated > ago(<TIMESPAN>)\n| summarize SignInCount = count(), UniqueIPs = dcount(IPAddress), FailedAttempts = countif(ResultType != "0")\n  by UserPrincipalName', 'output': 'UserPrincipalName\tSignInCount\tUniqueIPs\tFailedAttempts\ntemp.user@abc.com\t72\t4\t2', 'remarks': '', 'analyst_notes': ''}, {'step_number': 2, 'step_name': 'Verify VIP User Credentials', 'explanation': 'Investigate authentication logs for recent failed login attempts from VIP user accounts. Check server access logs and firewall alerts for any suspicious activity associated with these users', 'kql_query': 'SigninLogs\n| where UserPrincipalName == "<USER_EMAIL>"\n| where TimeGenerated > ago(<TIMESPAN>)\n| summarize SignInCount = count(), UniqueIPs = dcount(IPAddress), FailedAttempts = countif(ResultType != "0")\n  by UserPrincipalName', 'output': 'UserPrincipalName\tSignInCount\tUniqueIPs\tFailedAttempts\ntemp.user@abc.com\t72\t4\t2', 'remarks': '', 'analyst_notes': ''}, {'step_number': 3, 'step_name': 'Verify User/Device Location Timestamp', 'explanation': 'Review login event details (user account, IP address, time,  Geo location & User agent)\nAnalyze audit and signin logs to identify successful and failed attempts for last 7 days & device history.', 'kql_query': 'SigninLogs\n| where UserPrincipalName == "<USER_EMAIL>"\n| 
extend DeviceId = tostring(DeviceDetail.deviceId)\n| extend IsCompliant = tostring(DeviceDetail.isCompliant)\n| summarize by DeviceId, IsCompliant', 'output': 'UserPrincipalName\tSignInCount\tUniqueIPs\tFailedAttempts\ntemp.user@abc.com\t72\t4\t2', 'remarks': '', 'analyst_notes': ''}, {'step_number': 4, 'step_name': 'Verify IP Reputation Using VirusTotal', 'explanation': 'Check IP reputation using VirusTotal\nIf bad score, take a screenshot for documentation', 'kql_query': '', 'output': 'VirusTotal IP Reputation Check\n    ==================================================\n\n    IP Address: 8.8.8.8\n    Reputation: [OK] CLEAN\n    Risk Level: LOW\n\n    Detection Results:\n    ‚Ä¢ Malicious: 0/95\n    
‚Ä¢ Suspicious: 0/95\n    ‚Ä¢ Harmless: 62/95\n    ‚Ä¢ Undetected: 33/95\n\n    Network Details:\n    ‚Ä¢ Country: US\n    ‚Ä¢ ASN: 15169\n    ‚Ä¢ Owner: 
GOOGLE\n\n    Recommendation:\n    [NO ACTION] IP appears clean. Continue with standard investigation.\n\n    Verified: 2025-10-24 22:54:49\n 
   VirusTotal URL: https://www.virustotal.com/gui/ip-address/8.8.8.8', 'remarks': '', 'analyst_notes': ''}]
INFO:backend.predictions_backend:Initial analysis for temp.user@abc.com
INFO:backend.predictions_backend:Total steps: 4
INFO:backend.predictions_backend:Steps with output: 4
INFO:backend.predictions_backend:Sending prompt to Gemini API...
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1761326751.934899   23560 alts_credentials.cc:93] ALTS creds ignored. Not running on GCP and untrusted ALTS is not enabled.
INFO:backend.predictions_backend:Gemini response length: 1414
INFO:backend.predictions_backend:Cleaned response preview: {\n    "classification": "FALSE POSITIVE",\n    "risk_level": "Low",\n    "confidence_score": 60,\n    "key_findings": [\n        {\n            "step_reference": "Verify User Count Impacted",\n
ERROR:backend.predictions_backend:JSON parse error: Expecting property name enclosed in double quotes: line 1 column 2 (char 1)
ERROR:backend.predictions_backend:Raw content: {
    "classification": "FALSE POSITIVE",
    "risk_level": "Low",
    "confidence_score": 60,
    "key_findings": [
        {
            "step_reference": "Verify User Count Impacted",
            "category": "Account Monitoring",
            "severity": "Low",
            "details": "The user has logged in 72 times, from 4 unique IPs, with 2 failed attempts. While the number of logins is not extremely high, the failed attempts indicate a need to investigate further but doesn't necessarily indicate malicious activity.",
            "evidence": "UserPrincipalName: temp.user@abc.com, SignInCount: 72, UniqueIPs: 4, FailedAttempts: 2",
            "impact": "Potentially compromised account"
        },
        {
            "step_reference": "Verify IP Reputation Using VirusTotal",
            "category": "Network Security",
            "severity": "Low",
            "details": "The IP address (8.8.8.8) used by the user is reported as clean by VirusTotal, indicating no immediate threat from that source. This IP is associated with Google.",
            "evidence": "VirusTotal report shows a clean reputation for 8.8.8.8",
            "impact": "Reduced threat level"
        }
    ],
    "risk_indicators": [
        {
            "indicator": "Failed Login Attempts",
            "severity": "Low",
            "evidence": "2 failed login attempts for temp.user@abc.com"
        }
    ]
}
INFO:backend.predictions_backend:Using fallback analysis
JSON parsing error in MITRE analysis: Expecting property name enclosed in double quotes: line 1 column 2 (char 1)
{'status': 'success', 'analysis_timestamp': '2025-10-24T22:56:29.307918', 'initial_analysis': {'classification': 'TRUE POSITIVE', 'risk_level': 'High', 'confidence_score': 95, 'key_findings': [{'step_reference': 'Verify User Count Impacted', 'category': 'Suspicious Activity', 'severity': 'High', 'details': 'Failed attempts or suspicious indicators detected', 'evidence': 'userprincipalname\tsignincount\tuniqueips\tfailedattempts\ntemp.user@abc.com\t72\t4\t2', 'impact': 'Potential security concern'}, {'step_reference': 'Verify VIP User Credentials', 'category': 'Suspicious Activity', 'severity': 'High', 'details': 'Failed attempts or suspicious indicators detected', 'evidence': 'userprincipalname\tsignincount\tuniqueips\tfailedattempts\ntemp.user@abc.com\t72\t4\t2', 'impact': 'Potential security concern'}, {'step_reference': 'Verify User/Device Location Timestamp', 'category': 'Suspicious Activity', 'severity': 'High', 'details': 'Failed attempts or suspicious indicators detected', 'evidence': 'userprincipalname\tsignincount\tuniqueips\tfailedattempts\ntemp.user@abc.com\t72\t4\t2', 'impact': 'Potential security concern'}, {'step_reference': 'Verify IP Reputation Using VirusTotal', 'category': 'Suspicious Activity', 'severity': 'High', 'details': 'Failed attempts or suspicious indicators detected', 'evidence': 'virustotal ip reputation check\n    ==================================================\n\n    ip address: 8.8.8.8\n    reputation: [ok] clean\n    risk level: low\n\n    detection results:\n    ‚Ä¢ malicious: 0', 'impact': 'Potential 
security concern'}], 'risk_indicators': [{'indicator': 'Investigation completeness', 'severity': 'Low', 'evidence': 'Only 4 steps have output 
data'}]}, 'mitre_attack_analysis': {}, 'executive_summary': {'one_line_summary': 'TRUE POSITIVE - High risk investigation for temp.user@abc.com', 'attack_sophistication': 'Medium', 'business_impact': 'High', 'immediate_actions': ['Review authentication logs', 'Check for suspicious IP addresses', 'Verify user account status', 'Implement MFA if not enabled'], 'investigation_priority': 'P1', 'key_sub_techniques_observed': []}, 'geographic_risk': {'has_high_risk_country': False, 'high_risk_locations': [], 'suspicious_ips': []}, 'investigation_steps_analyzed': 4}    
INFO:     127.0.0.1:63192 - "POST /predictions/analyze/complete?api_key=AIzaSyDL1Bg1Cpk7XUiPTp4O4bn4jb5VgISY9Lw HTTP/1.1" 200 OK






Enter username/email to analyze

temp.user@abc.com
Select analysis type:


Complete Analysis


Initial Classification Only


MITRE Mapping Only


üìä Data preview: 5 rows loaded

‚úÖ Complete analysis finished!

üîç Investigation Assessment for: temp.user@abc.com
üö® Classification: TRUE POSITIVE

Risk Level

‚ö™ High
Confidence Score

95%
üîé Key Findings by Investigation Step
üü† Finding #1: Suspicious Activity (HIGH)

üîç Step Reference: Verify User Count Impacted

üìù Details: Failed attempts or suspicious indicators detected

üî¨ Evidence: userprincipalname signincount uniqueips failedattempts temp.user@abc.com 72 4 2

‚ö†Ô∏è Impact: Potential security concern

üü† Finding #2: Suspicious Activity (HIGH)

üîç Step Reference: Verify VIP User Credentials

üìù Details: Failed attempts or suspicious indicators detected

üî¨ Evidence: userprincipalname signincount uniqueips failedattempts temp.user@abc.com 72 4 2

‚ö†Ô∏è Impact: Potential security concern

üü† Finding #3: Suspicious Activity (HIGH)

üîç Step Reference: Verify User/Device Location Timestamp

üìù Details: Failed attempts or suspicious indicators detected

üî¨ Evidence: userprincipalname signincount uniqueips failedattempts temp.user@abc.com 72 4 2

‚ö†Ô∏è Impact: Potential security concern

üü† Finding #4: Suspicious Activity (HIGH)

üîç Step Reference: Verify IP Reputation Using VirusTotal

üìù Details: Failed attempts or suspicious indicators detected

üî¨ Evidence: virustotal ip reputation check ==================================================

ip address: 8.8.8.8
reputation: [ok] clean
risk level: low

detection results:
‚Ä¢ malicious: 0

‚ö†Ô∏è Impact: Potential security concern

üì• Download Complete Report





I can see only the half output Also I can see it's false positive but showing true positive