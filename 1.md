Step Name Explanation Input KQL Query Execute Output Remarks/Comments
Rule Analysis: Rule#183-Detect passwordless authentication Comprehensive triaging plan based on 62 historical incidents
1 Incident 208306 Incident details and security context Document investigation findings. | High FP rate (100.0%) - typically legitimate
2 Reported Time 07-01-2025 13:05 Incident details and security context Typically shows: 07-01-2025 13:05 | High FP rate (100.0%) - typically legitimate
3 Provide the username which are involved in the incident obarkhordarian@arcutis.com,jfennewald@arcutis.com,nkolla@arcutis.com Incident details and security context Typically shows: obarkhordarian@arcutis.com,jfennewald@arcutis.com,nkolla@arcutis.com | High FP rate (100.0%) - typically legitimate
4 VIPS Users ? No source ip address, reputation score "SigninLogs
| where UserPrincipalName == ""<USER_EMAIL>""
| where TimeGenerated > ago(7d)
| distinct IPAddress
| project IPAddress" Typically shows: Clean IP, No malicious reputation, Known IP range. If found → False Positive. | High FP rate (100.0%) - typically legitimate
5 Run the KQL query Triaging steps: IP : Clean, Closure comments :Observed events, checked sign in logs of users(obarkhordarian@arcutis.com,jfennewald@arcutis.com,nkolla@arcutis.com), clean IP, using registered devices and known apps nothing suspicious found , closing as a false positive. user principal name, source ip address, application name, device information "SigninLogs
| where TimeGenerated > ago(7d)
| where AuthenticationRequirement == ""singleFactorAuthentication""
| mv-expand todynamic(AuthenticationDetails)
| extend AuthMethod = tostring(AuthenticationDetails.authenticationMethod)
| where AuthMethod in (""FIDO2 security key"", ""Passwordless phone sign-in"", ""Windows Hello for Business"")
| project TimeGenerated, UserPrincipalName, IPAddress, Location, AppDisplayName, AuthMethod, DeviceDetail
| order by TimeGenerated desc" Typically shows: Triaging steps: IP : Clean, Closure comments :Observed events, checked sign in logs of users(obarkhordarian@arcutis.com,jfennewald@arcutis.com,nkolla@arcutis.com), clean IP, using registered devices and known apps nothing suspicious found , closing as a false positive. | High FP rate (100.0%) - typically legitimate
6 Collect the basic info like UserName, App DisplayName, User Agent, Time Triaging steps: IP : Clean, Closure comments :Observed events, checked sign in logs of users(obarkhordarian@arcutis.com,jfennewald@arcutis.com,nkolla@arcutis.com), clean IP, using registered devices and known apps nothing suspicious found , closing as a false positive. user principal name, source ip address, application name, device information Typically shows: Triaging steps: IP : Clean, Closure comments :Observed events, checked sign in logs of users(obarkhordarian@arcutis.com,jfennewald@arcutis.com,nkolla@arcutis.com), clean IP, using registered devices and known apps nothing suspicious found , closing as a false positive. | High FP rate (100.0%) - typically legitimate
7 User Confirmation - If YES No need user principal name Typically shows: User confirmed legitimate activity. If found → False Positive. | High FP rate (100.0%) - typically legitimate
8 User Confirmation --- NO. (True Positive) Complete User Confirmation --- NO. (True Positive) user principal name Typically shows: User confirmed legitimate activity. If found → False Positive. | High FP rate (100.0%) - typically legitimate
9 Run The KQL to check - AD logs (Sign in logs) Yes, run user signin logs user principal name, authentication logs "SigninLogs
| where TimeGenerated > ago(7d)
| where AuthenticationRequirement == ""singleFactorAuthentication""
| mv-expand todynamic(AuthenticationDetails)
| extend AuthMethod = tostring(AuthenticationDetails.authenticationMethod)
| where AuthMethod in (""FIDO2 security key"", ""Passwordless phone sign-in"", ""Windows Hello for Business"")
| project TimeGenerated, UserPrincipalName, IPAddress, Location, AppDisplayName, AuthMethod, DeviceDetail
| order by TimeGenerated desc" Typically shows: Yes, run user signin logs | High FP rate (100.0%) - typically legitimate
10 User Account Details iwalsh@arcutis.com Incident details and security context Typically shows: iwalsh@arcutis.com | High FP rate (100.0%) - typically legitimate
11 Inform to IT Team no need Incident details and security context Document investigation findings. | High FP rate (100.0%) - typically legitimate
12 Track for the closer/closer confirmation Complete Track for the closer/closer confirmation Incident details and security context Document investigation findings. | High FP rate (100.0%) - typically legitimate
13 Final Classification Classify the incident based on all investigation findings and evidence collected from previous steps. Consider the overall context, user behavior patterns, and threat indicators. All investigation findings from previous steps Options: True Positive, False Positive, Benign Positive. Historical baseline: 100.0% FP, 0.0% TP
14 Confidence Level Assessment Assess your confidence level in the classification based on the quality and completeness of evidence gathered. High confidence requires strong, corroborating evidence from multiple sources. Evidence quality, completeness, and consistency Scale: High (strong evidence from multiple sources), Medium (moderate evidence with some gaps), Low (limited or conflicting evidence)
15 Detailed Justification Provide comprehensive reasoning for the classification decision. Reference specific findings from investigation steps, including IP reputation, user behavior, MFA status, and any anomalies detected. Classification decision and supporting evidence Be specific - reference step numbers and exact findings that support your conclusion
16 Actions Taken Document all investigative actions performed during the triage process. Include queries executed, logs reviewed, external tools used, users or teams contacted, and timeline of investigation activities. Investigation activities log Include: KQL queries run, threat intelligence checks, user confirmations, system checks performed
17 Escalation Decision Determine if the incident requires escalation based on classification, severity, and organizational escalation policy. Consider factors such as confirmed malicious activity, VIP user involvement, or data exposure. Final classification, severity assessment, escalation criteria Escalate to: L3 SOC (confirmed threats), IT Team (system issues), Security Manager (VIP/critical), Incident Response Team (active compromise)

This is the output that you're generating right now in the explaination i want how to perform the step 1 keep in input what is required for the kql query and provide query in each step except

Incident Reported Time Provide the username which are involved in the incident

Incident Reported Time Provide the username which are involved in the incident VIPS Users ? Run the KQL query Collect the basic info like UserName, App DisplayName, User Agent, Time User Confirmation - If YES User Confirmation --- NO. (True Positive) Run The KQL to check - AD logs (Sign in logs) User Account Details Inform to IT Team Track for the closer/closer confirmation Final Classification Confidence Level Assessment Detailed Justification Actions Taken Escalation Decision HISTORICAL REFERENCE DATA Total Historical Incidents False Positive Rate True Positive Rate Common FP Justifications Typical FP Indicators

Also these steps are very vague use data wisely and give me only which section to update keep the resolver comments as empty also remember don't hardcode the data or any query nothing 
