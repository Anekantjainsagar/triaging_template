Step Name Explanation KQL Query KQL Explanation Execute Output Remarks/Comments
297  
1 Check User Count Impacted Gather details of all users - (By adding sheet to this excel) "SigninLogs
| where UserPrincipalName == ""<USER_EMAIL>""
| where TimeGenerated > ago(<TIMESPAN>)
| summarize SignInCount = count(), UniqueIPs = dcount(IPAddress), FailedAttempts = countif(ResultType != ""0"")
by UserPrincipalName" Queries sign-in activity, aggregates data. "UserPrincipalName SignInCount UniqueIPs FailedAttempts
temp.user@abc.com 72 4 2"  
2 Verify Users Against VIP List Verify users against VIP list in Authentication logs for recent activity "SigninLogs
| where UserPrincipalName == ""<USER_EMAIL>""
| where TimeGenerated > ago(<TIMESPAN>)
| summarize SignInCount = count(), UniqueIPs = dcount(IPAddress), FailedAttempts = countif(ResultType != ""0"")
by UserPrincipalName" Queries sign-in activity, aggregates data. "UserPrincipalName SignInCount UniqueIPs FailedAttempts
temp.user@abc.com 72 4 2"  
3 Verify Login Event Details "Review login event details (user account, IP address, time, Geo location & User agent)
Analyze audit and signin logs to identify successful and failed attempts for last 7 days & device history." "SigninLogs
| where UserPrincipalName == ""<USER_EMAIL>""
| where TimeGenerated > ago(<TIMESPAN>)
| summarize SignInCount = count(), UniqueIPs = dcount(IPAddress), FailedAttempts = countif(ResultType != ""0"")
by UserPrincipalName" Queries sign-in activity, aggregates data. "UserPrincipalName SignInCount UniqueIPs FailedAttempts
temp.user@abc.com 72 4 2"  
4 Verify IP Reputation Using VirusTotal "Check IP reputation using VirusTotal
If bad score, take a screenshot for documentation" "VirusTotal IP Reputation Check
==================================================
IP Address: 8.8.8.8
Reputation: [OK] CLEAN
Risk Level: LOW
Detection Results:
• Malicious: 0/95
• Suspicious: 0/95
• Harmless: 62/95
• Undetected: 33/95
Network Details:
• Country: US
• ASN: 15169
• Owner: GOOGLE
Recommendation:
[NO ACTION] IP appears clean. Continue with standard investigation.
Verified: 2025-10-24 17:21:20
VirusTotal URL: https://www.virustotal.com/gui/ip-address/8.8.8.8"  
5 Verify Suspicious Activity Confirmation Based on the investigation, if you still find it suspicious, then get confirmation from the user. If user confirms then close it as: False Positive  
6 Verify Unknown Activity If user says they are not aware about the acitivty then treat it as : True Positive Review relevant logs and documentation. Gather evidence from available security tools and systems. Document all findings with timestamps and sources.  
7 Verify Account Reset Status Reach out to the Network/EDR teams to block the detected suspicious IP, Inform user to reset password, maintain complex password and enable MFA.  
8 Verify Closer Confirmation Received After all the investigation document the steps taken, findings, and any remediation actions required

This is the new template 

Sr.No. Inputs Required Input Details Instructions 1 Rule#297 - Detecting unusual login patterns with behavior analytics rule This alert is triggred when one or more successful or failed authentication attempts, or session initiations, that significantly deviate from the user’s established behavioral baseline — including unusual geolocation, IP address, device, time of access, or user agent 2 Incident Number 213329 3 How many users are impacted ? 1 Gather details of all users - (By adding sheet to this excel) 4 VIP Users No Cross-check usernames with VIP list from Arcutis 5 Run the KQL query then, Check for IP Address, UserName, Location & Time and User agent Observed the events , checked the sign in logs for the user - Vchittepu@arcutis.com, all failed logis were seen , the location is US and the Ip is clean in virus total, (50.226.4.130 ) hence closing as FP. Review login event details (user account, IP address, time, Geo location & User agent) Analyze audit and signin logs to identify successful and failed attempts for last 7 days & device history. 6 IP Validation - if Malicious No Check IP reputation using VirusTotal If bad score, take a screenshot for documentation 7 User Confirmation --- Yes. Not Required Based on the investigation, if you still find it suspicious, then get confirmation from the user. If user confirms then close it as: False Positive 8 User Confirmation --- NO. If user says they are not aware about the acitivty then treat it as : True Positive 9 Inform to IT Team to Reset the account, Revoke the MFA tokens, Temporary disable the account NA Reach out to the Network/EDR teams to block the detected suspicious IP, Inform user to reset password, maintain complex password and enable MFA. 10 Track for the closer/closer confirmation Closed After all the investigation document the steps taken, findings, and any remediation actions required

this is the original template

In this when you're learning from this data you're hardcoding the steps but not seeing that some last steps are not for triaging they are for the verification of the data when it will be decided true/false positive don't follow the things just take learnings from that and do one thing to get some understanding about the alert you can use the technical details of this alert analysis just take that part only so it'll be easy for you do decide which step is relevent if you want you can use that and if you need any file that you don't have then ask me about that and give me the updated section/function don't waste the tokens

the idea is it's not about only kql it's about the steps that are relevent for the investigation just keep those things if not contributing anytihng in the investigation why keep that thing here is teh file
