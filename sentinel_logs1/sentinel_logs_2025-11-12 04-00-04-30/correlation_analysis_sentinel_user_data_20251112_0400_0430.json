{
  "report_metadata": {
    "generated_at": "2025-11-12T14:27:34.581254",
    "report_type": "Advanced Security Correlation Analysis v5.1 - AI-Enhanced Edition",
    "total_users": 4,
    "total_events": 12,
    "ai_enhanced": true,
    "generation_time_seconds": 19.645079612731934,
    "api_stats": {
      "total_requests": 10,
      "total_wait_time": 0,
      "requests_last_minute": 10,
      "requests_today": 10,
      "rpm_limit": 15,
      "rpd_limit": 1500,
      "rate_limit_exceeded": false
    },
    "improvements": [
      "Intelligent time gap detection using outlier analysis",
      "Proper ResultDescription extraction for failures",
      "Enhanced Unknown data handling",
      "Frequent activity grouping (not hardcoded thresholds)",
      "AI-generated alert descriptions with rate limiting"
    ]
  },
  "summary": {
    "high_risk_count": 0,
    "medium_risk_count": 0,
    "low_risk_count": 4
  },
  "high_priority_events": [],
  "medium_priority_events": [],
  "low_priority_events": [
    {
      "user_principal_name": "raviraj.jadhav@yash.com",
      "user_id": "6c65fe55-abdc-4b88-a95a-b15dd04f53ce",
      "user_display_name": "Raviraj Ramesh Jadhav",
      "user_type": "Guest",
      "total_events": 2,
      "total_clusters": 2,
      "clusters": [
        {
          "clustering_metadata": {
            "method": "iqr_outlier_detection",
            "q1": 56.385282,
            "q2": 56.385282,
            "q3": 56.385282,
            "iqr": 0.0,
            "mean": 56.385282,
            "std_dev": 0.0,
            "normal_gaps_count": 1,
            "outlier_count": 0,
            "total_gaps": 1,
            "final_threshold": 56.385282
          }
        },
        {
          "cluster_id": "CLUSTER_000",
          "start_time": "2025-11-12T04:18:44.632134+00:00",
          "end_time": "2025-11-12T04:18:44.632134+00:00",
          "duration_seconds": 0,
          "event_count": 1,
          "unique_apps": 1,
          "has_failures": false,
          "failure_count": 0
        },
        {
          "cluster_id": "CLUSTER_001",
          "start_time": "2025-11-12T04:19:41.017416+00:00",
          "end_time": "2025-11-12T04:19:41.017416+00:00",
          "duration_seconds": 0,
          "event_count": 1,
          "unique_apps": 1,
          "has_failures": false,
          "failure_count": 0
        }
      ],
      "locations": [
        {
          "city": "Kothrud",
          "state": "Maharashtra",
          "country": "IN",
          "ip_address": "203.199.133.30",
          "timestamp": "2025-11-12T04:18:44.6321342Z"
        }
      ],
      "unique_locations": 1,
      "applications": [
        {
          "app_name": "YASH-SPN-UES-Azure-App",
          "app_id": "b8d957b6-3709-49a0-b182-1bc63498c116",
          "resource": "Microsoft Graph",
          "access_count": 1
        },
        {
          "app_name": "Azure DevOps",
          "app_id": "499b84ac-1321-427f-aa17-267ca6975798",
          "resource": "Azure DevOps",
          "access_count": 1
        }
      ],
      "unique_apps": 2,
      "authentication_summary": {
        "methods": [
          "Single Sign-On"
        ],
        "total_mfa": 0,
        "total_single_factor": 2,
        "failed_attempts": 0
      },
      "failure_analysis": {
        "total_failures": 0,
        "success_rate": 100.0,
        "failure_reasons": [],
        "critical_failures": 0,
        "failed_event_timeline": [],
        "failure_categories": {}
      },
      "behavioral_anomalies": [],
      "risk_score": 3,
      "risk_factors": [
        "Predominantly single-factor authentication",
        "Guest user cross-tenant access"
      ],
      "timeline": [
        {
          "timestamp": "2025-11-12T04:18:44.6321342Z",
          "app": "YASH-SPN-UES-Azure-App",
          "location": "Kothrud, IN",
          "ip_address": "203.199.133.30",
          "browser": "Chrome 142.0.0",
          "os": "Windows10",
          "result": "\u2705 Success",
          "auth_method": "Single Sign-On"
        },
        {
          "timestamp": "2025-11-12T04:19:41.0174167Z",
          "app": "Azure DevOps",
          "location": "Kothrud, IN",
          "ip_address": "203.199.133.30",
          "browser": "Chrome 142.0.0",
          "os": "Windows10",
          "result": "\u2705 Success",
          "auth_method": "Single Sign-On"
        }
      ],
      "alert_title": "\u26a0\ufe0f [LOW RISK] Cross-Tenant Guest Activity & Weak Authentication Methods - Raviraj Ramesh Jadhav (2 events)",
      "alert_summary": "Normal activity pattern",
      "alert_description": "We've identified that Raviraj, a guest user, successfully accessed two of our applications. This is concerning because it involved a guest user accessing resources across different parts of our system, and their access was primarily secured by only a single password, which presents a higher security risk."
    },
    {
      "user_principal_name": "rohan.karekar@yash.com",
      "user_id": "5e50bd0d-a115-4d2f-9687-1d9d81bb4bcc",
      "user_display_name": "Rohan Karekar",
      "user_type": "Guest",
      "total_events": 1,
      "total_clusters": 1,
      "clusters": [
        {
          "clustering_metadata": {
            "method": "default",
            "reason": "insufficient_events"
          }
        },
        {
          "cluster_id": "CLUSTER_000",
          "start_time": "2025-11-12T04:23:28.482639+00:00",
          "end_time": "2025-11-12T04:23:28.482639+00:00",
          "duration_seconds": 0,
          "event_count": 1,
          "unique_apps": 1,
          "has_failures": false,
          "failure_count": 0
        }
      ],
      "locations": [
        {
          "city": "Thathawade (Dattwadi)",
          "state": "Maharashtra",
          "country": "IN",
          "ip_address": "2401:4900:1c17:ee07:98fd:c089:d800:6827",
          "timestamp": "2025-11-12T04:23:28.4826398Z"
        }
      ],
      "unique_locations": 1,
      "applications": [
        {
          "app_name": "Azure DevOps",
          "app_id": "499b84ac-1321-427f-aa17-267ca6975798",
          "resource": "Azure DevOps",
          "access_count": 1
        }
      ],
      "unique_apps": 1,
      "authentication_summary": {
        "methods": [
          "Single Sign-On"
        ],
        "total_mfa": 0,
        "total_single_factor": 1,
        "failed_attempts": 0
      },
      "failure_analysis": {
        "total_failures": 0,
        "success_rate": 100.0,
        "failure_reasons": [],
        "critical_failures": 0,
        "failed_event_timeline": [],
        "failure_categories": {}
      },
      "behavioral_anomalies": [],
      "risk_score": 3,
      "risk_factors": [
        "Predominantly single-factor authentication",
        "Guest user cross-tenant access"
      ],
      "timeline": [
        {
          "timestamp": "2025-11-12T04:23:28.4826398Z",
          "app": "Azure DevOps",
          "location": "Thathawade (Dattwadi), IN",
          "ip_address": "2401:4900:1c17:ee07:98fd:c089:d800:6827",
          "browser": "Chrome 142.0.0",
          "os": "MacOs",
          "result": "\u2705 Success",
          "auth_method": "Single Sign-On"
        }
      ],
      "alert_title": "\u26a0\ufe0f [LOW RISK] Cross-Tenant Guest Activity & Weak Authentication Methods - Rohan Karekar (1 events)",
      "alert_summary": "Normal activity pattern",
      "alert_description": "We've detected that a guest user, Rohan Karekar, successfully accessed resources across different parts of our organization, which is unusual for a guest account. This \"cross-tenant\" access, especially when only protected by a single password, is concerning as it could potentially expose sensitive information or lead to unauthorized access."
    },
    {
      "user_principal_name": "dewanshsingh@yashtechnologies841.onmicrosoft.com",
      "user_id": "1b5fa5f6-b4af-48fe-a44a-42cf9b6b5f6e",
      "user_display_name": "dewansh singh",
      "user_type": "Member",
      "total_events": 8,
      "total_clusters": 2,
      "clusters": [
        {
          "clustering_metadata": {
            "method": "iqr_outlier_detection",
            "q1": 9.382601000000001,
            "q2": 13.407047,
            "q3": 23.0346005,
            "iqr": 13.651999499999999,
            "mean": 21.518608714285715,
            "std_dev": 21.799092428211473,
            "normal_gaps_count": 6,
            "outlier_count": 1,
            "total_gaps": 7,
            "final_threshold": 30
          }
        },
        {
          "cluster_id": "CLUSTER_000",
          "start_time": "2025-11-12T04:26:50.157022+00:00",
          "end_time": "2025-11-12T04:28:09.159239+00:00",
          "duration_seconds": 79,
          "event_count": 7,
          "unique_apps": 3,
          "has_failures": false,
          "failure_count": 0
        },
        {
          "cluster_id": "CLUSTER_001",
          "start_time": "2025-11-12T04:29:20.787283+00:00",
          "end_time": "2025-11-12T04:29:20.787283+00:00",
          "duration_seconds": 0,
          "event_count": 1,
          "unique_apps": 1,
          "has_failures": false,
          "failure_count": 0
        }
      ],
      "locations": [
        {
          "city": "Ahmedabad",
          "state": "Gujarat",
          "country": "IN",
          "ip_address": "49.249.104.218",
          "timestamp": "2025-11-12T04:26:50.1570222Z"
        },
        {
          "city": "Navi Mumbai",
          "state": "Maharashtra",
          "country": "IN",
          "ip_address": "14.143.131.254",
          "timestamp": "2025-11-12T04:27:16.0570435Z"
        }
      ],
      "unique_locations": 2,
      "applications": [
        {
          "app_name": "Azure Portal",
          "app_id": "c44b4083-3bb0-49c1-b47d-974e53cbdf3c",
          "resource": "Azure Portal",
          "access_count": 3
        },
        {
          "app_name": "Office365 Shell WCSS-Client",
          "app_id": "89bee1f7-5e6e-4d8a-9f3d-ecd601259da7",
          "resource": "Microsoft Graph",
          "access_count": 3
        },
        {
          "app_name": "Microsoft 365 Security and Compliance Center",
          "app_id": "80ccca67-54bd-44ab-8625-4b79c4dc7775",
          "resource": "Windows Azure Active Directory",
          "access_count": 1
        },
        {
          "app_name": "Microsoft Account Controls V2",
          "app_id": "7eadcef8-456d-4611-9480-4fff72b8b9e2",
          "resource": "Microsoft Graph",
          "access_count": 1
        }
      ],
      "unique_apps": 4,
      "authentication_summary": {
        "methods": [
          "Single Sign-On"
        ],
        "total_mfa": 8,
        "total_single_factor": 0,
        "failed_attempts": 0
      },
      "failure_analysis": {
        "total_failures": 0,
        "success_rate": 100.0,
        "failure_reasons": [],
        "critical_failures": 0,
        "failed_event_timeline": [],
        "failure_categories": {}
      },
      "behavioral_anomalies": [],
      "risk_score": 3,
      "risk_factors": [
        "Rapid event cluster: 7 events in 79s"
      ],
      "timeline": [
        {
          "timestamp": "2025-11-12T04:26:50.1570222Z",
          "app": "Azure Portal",
          "location": "Ahmedabad, IN",
          "ip_address": "49.249.104.218",
          "browser": "Edge 142.0.0",
          "os": "Windows10",
          "result": "\u2705 Success",
          "auth_method": "Single Sign-On"
        },
        {
          "timestamp": "2025-11-12T04:27:16.0570435Z",
          "app": "Azure Portal",
          "location": "Navi Mumbai, IN",
          "ip_address": "14.143.131.254",
          "browser": "Edge 142.0.0",
          "os": "Windows10",
          "result": "\u2705 Success",
          "auth_method": "Single Sign-On"
        },
        {
          "timestamp": "2025-11-12T04:27:16.8178104Z",
          "app": "Office365 Shell WCSS-Client",
          "location": "Navi Mumbai, IN",
          "ip_address": "14.143.131.254",
          "browser": "Edge 142.0.0",
          "os": "Windows10",
          "result": "\u2705 Success",
          "auth_method": "Single Sign-On"
        },
        {
          "timestamp": "2025-11-12T04:27:36.9869903Z",
          "app": "Azure Portal",
          "location": "Ahmedabad, IN",
          "ip_address": "49.249.104.218",
          "browser": "Edge 142.0.0",
          "os": "Windows10",
          "result": "\u2705 Success",
          "auth_method": "Single Sign-On"
        },
        {
          "timestamp": "2025-11-12T04:27:50.3940379Z",
          "app": "Office365 Shell WCSS-Client",
          "location": "Ahmedabad, IN",
          "ip_address": "49.249.104.218",
          "browser": "Edge 142.0.0",
          "os": "Windows10",
          "result": "\u2705 Success",
          "auth_method": "Single Sign-On"
        },
        {
          "timestamp": "2025-11-12T04:28:01.0373893Z",
          "app": "Microsoft 365 Security and Compliance Center",
          "location": "Navi Mumbai, IN",
          "ip_address": "14.143.131.254",
          "browser": "Edge 142.0.0",
          "os": "Windows10",
          "result": "\u2705 Success",
          "auth_method": "Single Sign-On"
        },
        {
          "timestamp": "2025-11-12T04:28:09.1592398Z",
          "app": "Office365 Shell WCSS-Client",
          "location": "Navi Mumbai, IN",
          "ip_address": "14.143.131.254",
          "browser": "Edge 142.0.0",
          "os": "Windows10",
          "result": "\u2705 Success",
          "auth_method": "Single Sign-On"
        },
        {
          "timestamp": "2025-11-12T04:29:20.7872837Z",
          "app": "Microsoft Account Controls V2",
          "location": "Navi Mumbai, IN",
          "ip_address": "14.143.131.254",
          "browser": "Edge 142.0.0",
          "os": "Windows10",
          "result": "\u2705 Success",
          "auth_method": "Single Sign-On"
        }
      ],
      "alert_title": "\u26a0\ufe0f [LOW RISK] Suspicious Rapid Activity - dewansh singh (8 events)",
      "alert_summary": "2 locations | 4 applications",
      "alert_description": "We detected unusual activity on Dewansh Singh's account, where he accessed four different applications very quickly from two distinct locations within just over a minute. This rapid access from multiple places is concerning because it could indicate unauthorized access or a compromised account, even though all attempts were successful."
    },
    {
      "user_principal_name": "uday.sharma@yash.com",
      "user_id": "be4948de-7f30-4b44-9cc5-53e8bf1b4837",
      "user_display_name": "Uday  Sharma",
      "user_type": "Guest",
      "total_events": 1,
      "total_clusters": 1,
      "clusters": [
        {
          "clustering_metadata": {
            "method": "default",
            "reason": "insufficient_events"
          }
        },
        {
          "cluster_id": "CLUSTER_000",
          "start_time": "2025-11-12T04:10:02.414376+00:00",
          "end_time": "2025-11-12T04:10:02.414376+00:00",
          "duration_seconds": 0,
          "event_count": 1,
          "unique_apps": 1,
          "has_failures": false,
          "failure_count": 0
        }
      ],
      "locations": [
        {
          "city": "Indore",
          "state": "Madhya Pradesh",
          "country": "IN",
          "ip_address": "2405:201:302c:e12b:886c:17da:79c6:8309",
          "timestamp": "2025-11-12T04:10:02.4143762Z"
        }
      ],
      "unique_locations": 1,
      "applications": [
        {
          "app_name": "Azure Portal",
          "app_id": "c44b4083-3bb0-49c1-b47d-974e53cbdf3c",
          "resource": "Azure Resource Manager",
          "access_count": 1
        }
      ],
      "unique_apps": 1,
      "authentication_summary": {
        "methods": [
          "Single Sign-On"
        ],
        "total_mfa": 1,
        "total_single_factor": 0,
        "failed_attempts": 0
      },
      "failure_analysis": {
        "total_failures": 0,
        "success_rate": 100.0,
        "failure_reasons": [],
        "critical_failures": 0,
        "failed_event_timeline": [],
        "failure_categories": {}
      },
      "behavioral_anomalies": [],
      "risk_score": 2,
      "risk_factors": [
        "Guest user cross-tenant access"
      ],
      "timeline": [
        {
          "timestamp": "2025-11-12T04:10:02.4143762Z",
          "app": "Azure Portal",
          "location": "Indore, IN",
          "ip_address": "2405:201:302c:e12b:886c:17da:79c6:8309",
          "browser": "Edge 141.0.0",
          "os": "Windows10",
          "result": "\u2705 Success",
          "auth_method": "Single Sign-On"
        }
      ],
      "alert_title": "\u26a0\ufe0f [LOW RISK] Cross-Tenant Guest Activity - Uday  Sharma (1 events)",
      "alert_summary": "Normal activity pattern",
      "alert_description": "We've detected that a guest user, Uday Sharma, successfully accessed resources in a different part of our system than they were authorized for. This \"cross-tenant access\" is concerning because it could potentially expose sensitive information to unauthorized individuals, even if no malicious activity was observed in this instance."
    }
  ]
}