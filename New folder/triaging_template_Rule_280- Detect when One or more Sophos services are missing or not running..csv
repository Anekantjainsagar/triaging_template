Sr.No.,Inputs Required,INPUT details,Instructions
,,,"Rule#280- Detect when One or more Sophos services are missing or not running. - Based on 92 past incidents (62.0% FP, 30.4% TP)"
1,Verify if the user has a VIP status by checking their username in the status field of the users table.,,"json { ""user_id"": ""smith"", ""username"": ""smith@company.com"" } | Expected: Based on 92 past incidents (62.0% FP rate): Typically find 'Clean IP', 'No malicious reputation', 'Known IP range'. If found, indicates False Positive. | Expected: Based on 92 past incidents (62.0% FP rate): Typically find 'Clean IP', 'No malicious reputation', 'Known IP range'. If found, indicates False Positive."
2,"If no VIP status, proceed to Step B: Check for missing services or anomalies in the status field.",,"sql SELECT status FROM users WHERE username = 'smith@company.com' AND user_id = current_user.id LIMIT 1; Step B: Check Service Status | Expected: Based on 92 past incidents (62.0% FP rate): Typically find 'Clean IP', 'No malicious reputation', 'Known IP range'. If found, indicates False Positive. | Expected: Based on 92 past incidents (62.0% FP rate): Typically find 'Clean IP', 'No malicious reputation', 'Known IP range'. If found, indicates False Positive. | Query: SELECT status FROM users WHERE username = 'smith@company.com' AND user_id = current_user.id LIMIT 1;"
3,"Use Serper's Search API to search for any service that has an is_installed of False (indicating it is missing or not running) and a status related to ""Missing service"".",,"json https://google.serper.dev/search?q=missing+service&limit=50&country=US&location=global&locale=en Step C: Check for Known Issues | Expected: Based on 92 historical incidents: 62.0% were False Positive, 30.4% were True Positive. Investigate thoroughly."
4,Use Serper's Search API to search for any known issues that might cause a missing service or an uninstalled service.,,"json https://google.serper.dev/search?q=known+issues&limit=50&country=US&location=global&locale=en Step D: Check for Security Alerts and Trends | Expected: Based on 92 historical incidents: 62.0% were False Positive, 30.4% were True Positive. Investigate thoroughly."
5,"Review security alerts, trends, and any security logs (e.g., status changes) related to missing services or running services.",,"json { ""alert_ids"": [""890001234567890""], ""timestamp"": ""2023-04-01T00:00:00Z"", ""service_name"": ""Missing service"" } Step E: Compare with Known Apps | Expected: Based on 92 historical incidents: 62.0% were False Positive, 30.4% were True Positive. Investigate thoroughly."
6,"Compare the user's known apps (e.g., apps table) to any known services installed and running.",,"json SELECT DISTINCT application_id FROM users WHERE username = 'smith@company.com' AND current_user.id IS NOT NULL LIMIT 10; Step F: Perform a full data search | Expected: Expected result (62.0% FP rate): 'Known applications', 'Approved apps', 'Whitelisted applications'. Indicates normal activity."
7,Use Serper's Search API to perform an extensive data search across all organizations for any known services that might be missing or running.,,"json https://google.serper.dev/search?q=known+services&limit=50&country=US&location=global&locale=en Step G: Verify the Security Configuration | Expected: Based on 92 historical incidents: 62.0% were False Positive, 30.4% were True Positive. Investigate thoroughly."
8,"Check if there are any security configurations (e.g., security_config object) that might be affecting services.",,"json { ""configurations"": { ""name"": ""Security Config"", ""value"": { ""enabled"": true, ""services"": [ ""Missing service"", ""Service A"" ] } }, ""timestamp"": ""2023-04-01T00:00:00Z"" } Step H: Update the User with Details | Expected: Based on 92 historical incidents: 62.0% were False Positive, 30.4% were True Positive. Investigate thoroughly."
9,Final Classification,,"Classify as True Positive, False Positive, or Benign Positive based on all investigation findings. [HISTORICAL BASELINE] 62.0% FP, 30.4% TP from 92 past incidents"
10,Confidence Level,,"Assess confidence: High (strong evidence from multiple sources), Medium (moderate evidence with some gaps), Low (limited or conflicting evidence)"
11,Detailed Justification,,Provide comprehensive reasoning for classification. Reference specific findings from investigation steps above with step numbers and exact evidence
12,Actions Taken,,"Document all investigative actions: KQL queries executed, logs reviewed, threat intelligence checks performed, users/teams contacted, timeline of activities"
13,Escalation Required?,,"Yes/No - If yes, specify escalation path: L3 SOC (confirmed threats), IT Team (system issues), Security Manager (VIP/critical assets), Incident Response Team (active compromise)"

,HISTORICAL REFERENCE DATA,,Statistical analysis from past incidents - use to inform investigation approach
,Total Past Incidents,92,Complete dataset of 92 historical incidents for pattern analysis
,False Positive Rate,62.0%,"57 of 92 incidents were False Positives. If similar patterns found, likelihood of FP is 62.0%"
,True Positive Rate,30.4%,"28 of 92 incidents were True Positives. If threat indicators found, likelihood of TP is 30.4%"
,Common FP Justifications,,"BAS Testing, All services were running, Clean status, Legitimate Asset, INC0095055, all services running, Device is clean, All services are running, Legitimate activity, Legitimate user, Device is clean , device is clean , IP Clean"
,Typical FP Indicators,,"Look for these patterns in your investigation: triaging steps performed: check ip reputation - clean. check hostname .. arq-00463 check history  for 90 day s/ 30 days.. etc  na check signin logs -- na escalating (yes/ no) yes closure comments for tp / fp / benign positive: tp (as checked all sophos services are not running) inc0095255 | checked the device in sophos, the device( arq-00304 )has been automatically updated by sophos and the status is clean | triaging steps performed: check ip reputation - clean. arc-pc-pf5bd8ec check hostname .check history – for 90 day s/ 30 days. etc – na check signin logs -- na escalating (yes/ no) yes closure comments for tp / fp / benign positive: tp (as checked all sophos services are not running) inc0095885 | triaging steps performed: check ip reputation - clean. check hostname .. arq-00450 check history  for 90 day s/ 30 days.. etc  na check signin logs -- na escalating (yes/ no) yes closure comments for tp / fp / benign positive: tp (as checked all sophos services are not running) inc0095260 | observed the events, device-arq-procdna-1,sophos services are missing or not running, based on eddie conversation need to wait or sometime and then check the sophos status is clean now so closing as tp | triaging steps performed: check ip reputation - clean. check hostname .. arq-00374 check history  for 90 day s/ 30 days.. etc  na check signin logs -- na escalating (yes/ no) yes closure comments for tp / fp / benign positive: tp (as checked all sophos services are not running) inc0095259 | triaging steps performed: check ip reputation - clean. arc-pc-pf45lcsn check hostname .check history – for 90 day s/ 30 days. etc – na check signin logs -- na escalating (yes/ no) yes closure comments for tp / fp / benign positive: tp (as checked all sophos services are not running) inc0095653 | as checked in sophos, the device(arq-mbp-035) all sophos services are not running based on eddie conversation need to wait or some time and then check the sophos status, now the status was clean so closing as tp (inc0095368) | triaging steps performed: check ip reputation - clean. check hostname .. arq-mbp-027 ,as checked all sophos services are running successfully so closing as fp. | triaging steps performed: check ip reputation - clean. check hostname .. arq-00476 check history  for 90 day s/ 30 days.. etc  na check signin logs -- na escalating (yes/ no) yes closure comments for tp / fp / benign positive: tp (as checked all sophos services are not running) inc0095136 | triaging steps performed: check ip reputation - clean. check hostname .. arq-00447 check history  for 90 day s/ 30 days.. etc  na check signin logs -- all services are running currently. na escalating (yes/ no) yes closure comments for tp / fp / benign positive: fp | as checked in sophos, the device(arq-mbp-058) all sophos services are not running based on eddie conversation need to wait or some time and then check the sophos status, now the status was clean so closing as bp | triaging steps performed: check ip reputation - clean. check hostname .. arq-pc-132 check history  for 90 day s/ 30 days.. etc  na check signin logs -- na escalating (yes/ no) yes closure comments for tp / fp / benign positive: tp (as checked all sophos services are not running) inc0095274 | triaging steps performed: check ip reputation - clean. check hostname .. arc-pc-pf5ajnsz check history  for 90 day s/ 30 days.. etc  na check signin logs -- na escalating (yes/ no) no (as checked all sophos services are running successfully so closing as fp. | triaging steps performed: check ip reputation - clean. check hostname .. pers-avd_10 check history  for 90 day s/ 30 days.. etc  na check signin logs -- na escalating (yes/ no) yes closure comments for tp / fp / benign positive: bp, as checked device, its related bas testing | observed events pers-avd-10 device is related bas testing nothing suspicious closing as beningn positive. | triaging steps performed: check ip reputation - clean. check hostname .. arq-00329 check history  for 90 day s/ 30 days.. etc  na check signin logs -- na escalating (yes/ no) yes closure comments for tp / fp / benign positive: tp (as checked all sophos services are not running, so informed to edr team and will check for raisig the ticket, so closing as true positive) | triaging steps performed: check ip reputation - clean.device(arq-mbp-014) ,as checked all sophos services are running successfully so closing as fp. | checked the device in sophos, the device( arq-mbp- 049 )has been automatically updated by sophos and the status is clean | triaging steps performed: check ip reputation - clean. arc-00403check hostname .check history – for 90 day s/ 30 days. etc – na check signin logs -- na escalating (yes/ no) yes closure comments for tp / fp / benign positive: tp (as checked all sophos services are not running) inc006076 | checked the device in sophos, the device( arq-mbp-058 )has been automatically updated by sophos and the status is clean"
,Typical TP Indicators,,"Red flags to watch for: triaging steps performed: check ip reputation - clean. check hostname .. arq-00463 check history  for 90 day s/ 30 days.. etc  na check signin logs -- na escalating (yes/ no) yes closure comments for tp / fp / benign positive: tp (as checked all sophos services are not running) inc0095255 | triaging steps performed: check ip reputation - clean. check hostname .. arq-00329 check history  for 90 day s/ 30 days.. etc  na check signin logs -- na escalating (yes/ no) yes closure comments for tp / fp / benign positive: tp (as checked all sophos services are not running, so informed to edr team and will check for raisig the ticket, so closing as true positive) | observed the events and checked the device arq-mac-fhn7qf675x,sophos services are missing or not running so escalated to yasasawini. | triaging steps performed: check ip reputation - clean. check hostname .. arq-00374 check history  for 90 day s/ 30 days.. etc  na check signin logs -- na escalating (yes/ no) yes closure comments for tp / fp / benign positive: tp (as checked all sophos services are not running) inc0095259 | triaging steps performed: check ip reputation - clean. check hostname .. arq-00476 check history  for 90 day s/ 30 days.. etc  na check signin logs -- na escalating (yes/ no) yes closure comments for tp / fp / benign positive: tp (as checked all sophos services are not running) inc0095136 | triaging steps performed: check ip reputation - clean. arc-pc-pf45lcsn check hostname .check history – for 90 day s/ 30 days. etc – na check signin logs -- na escalating (yes/ no) yes closure comments for tp / fp / benign positive: tp (as checked all sophos services are not running) inc0095653 | triaging steps performed: check ip reputation - clean. arc-pc-pf5bd8ec check hostname .check history – for 90 day s/ 30 days. etc – na check signin logs -- na escalating (yes/ no) yes closure comments for tp / fp / benign positive: tp (as checked all sophos services are not running) inc0095885 | triaging steps performed: check ip reputation - clean. check hostname .. arq-00447 check history  for 90 day s/ 30 days.. etc  na check signin logs -- all services are running currently. na escalating (yes/ no) yes closure comments for tp / fp / benign positive: fp | triaging steps performed: check hostname .. arq-mbp-056\jlewis check history  for 90 day s/ 30 days.. etc  na check signin logs -- na escalating (yes/ no) no (as checked all sophos services are running successfully so closing as fp. | triaging steps performed: check ip reputation - clean. arc-00403check hostname .check history – for 90 day s/ 30 days. etc – na check signin logs -- na escalating (yes/ no) yes closure comments for tp / fp / benign positive: tp (as checked all sophos services are not running) inc006076 | triaging steps performed: check ip reputation - clean. check hostname .. arq-pc-132 check history  for 90 day s/ 30 days.. etc  na check signin logs -- na escalating (yes/ no) yes closure comments for tp / fp / benign positive: tp (as checked all sophos services are not running) inc0095274 | triaging steps performed: check ip reputation - clean. check hostname .. pers-avd_10 check history  for 90 day s/ 30 days.. etc  na check signin logs -- na escalating (yes/ no) yes closure comments for tp / fp / benign positive: bp, as checked device, its related bas testing | triaging steps performed: check ip reputation - clean. check hostname .. arc-pc-pf5ajnsz check history  for 90 day s/ 30 days.. etc  na check signin logs -- na escalating (yes/ no) no (as checked all sophos services are running successfully so closing as fp. | triaging steps performed: check ip reputation - clean. check hostname .. arq-00450 check history  for 90 day s/ 30 days.. etc  na check signin logs -- na escalating (yes/ no) yes closure comments for tp / fp / benign positive: tp (as checked all sophos services are not running) inc0095260 | observed events pers-avd-10 device is related bas testing nothing suspicious closing as beningn positive."
